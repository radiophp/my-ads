# =======================================
# Non-secret environment variables
# =======================================

# Stack name consumed by the self-hosted runner during docker stack deploy.
DEPLOY_STACK_NAME=my-ads-production

NODE_ENV=production
APP_HOST=0.0.0.0
APP_PORT=6300
APP_GLOBAL_PREFIX=api

POSTGRES_DB=mahan_file
POSTGRES_USER=mahan_admin
POSTGRES_INTERNAL_PORT=5432
POSTGRES_PUBLISHED_PORT=6301

REDIS_HOST=redis
REDIS_PORT=6302
REDIS_DB=0
REDIS_TLS=false
REDIS_KEY_PREFIX=mahan-file:

RABBITMQ_HOST=rabbitmq
RABBITMQ_QUEUE_PREFIX=mahan-file
RABBITMQ_PREFETCH=5
RABBITMQ_HEARTBEAT=60
RABBITMQ_RECONNECT_SECONDS=5
RABBITMQ_PORT=6313
RABBITMQ_MANAGEMENT_PORT=6314
RABBITMQ_MANAGEMENT_URL=http://rabbitmq:15672
RABBITMQ_USERNAME=mahan_worker

MINIO_ENDPOINT=minio
MINIO_PORT=6304
MINIO_CONSOLE_PORT=6305
MINIO_USE_SSL=false
MINIO_BUCKET=mahan-file-uploads
MINIO_REGION=ir-tehran-1
MINIO_PUBLIC_ENDPOINT=mahanfile.com
MINIO_PUBLIC_PORT=443
MINIO_PUBLIC_USE_SSL=true
MINIO_PUBLIC_PATH=/storage

CORS_ORIGIN=https://mahanmelk.com
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=240
OTP_TTL_SECONDS=300
OTP_DIGITS=6

OTEL_ENABLED=false
OTEL_SERVICE_NAME=mahan-file-api
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:6317/v1/traces
OTEL_EXPORTER_OTLP_HEADERS=
OTEL_LOG_LEVEL=error

LOG_LEVEL=info
LOG_PRETTY=false
PRISMA_LOG_QUERIES=false

NEXT_UI_PORT=6306
NEXT_PUBLIC_APP_URL=https://mahanmelk.com
NEXT_PUBLIC_API_BASE_URL=https://mahanmelk.com/api
# Serve tiles via same-origin /map to avoid CORS
NEXT_PUBLIC_MAP_TILE_BASE_URL=/map
NEXT_PUBLIC_VAPID_PUBLIC_KEY=BJPGr5VE7KBZI1r6zo6kQM8LF9MllmtfnyI65mrH9MZ-MmRVvDr-dpgp0T4L7ornd-Trwb2VSi6MQgjrmHI0o2Q

NOTIFICATION_WINDOW_MINUTES=10
NOTIFICATION_SCAN_BATCH_SIZE=50
NOTIFICATION_RETRY_INTERVAL_MS=30000
NOTIFICATION_MAX_ATTEMPTS=3
NOTIFICATION_RETENTION_DAYS=3
NOTIFICATION_PUSH_ALWAYS=true
VAPID_PUBLIC_KEY=BJPGr5VE7KBZI1r6zo6kQM8LF9MllmtfnyI65mrH9MZ-MmRVvDr-dpgp0T4L7ornd-Trwb2VSi6MQgjrmHI0o2Q
VAPID_PRIVATE_KEY=5cUm6OFWaKk4ITc0UZAb6yp5TgGiondO0CCV-chTWEc
VAPID_SUBJECT=mailto:admin@example.com
PUSH_NOTIFICATION_TIMEOUT_MS=8000
TELEGRAM_SEND_TIMEOUT_MS=8000
TELEGRAM_SEND_RETRY_ATTEMPTS=5
TELEGRAM_SEND_RETRY_DELAY_MS=5000

# Image references are now fixed in docker-compose-prod.yml and always pull latest tags from GHCR.
# Keep these here only as documentation / future overrides.
API_IMAGE=ghcr.io/radiophp/my-ads-api
API_IMAGE_TAG=latest
UI_IMAGE=ghcr.io/radiophp/my-ads-ui
UI_IMAGE_TAG=latest
API_REPLICAS=2
UI_REPLICAS=2
API_CRON_REPLICAS=1
MAP_TILES_PORT=7235

# =======================================
# Secrets (store in GitHub Actions secrets)
# =======================================

GHCR_TOKEN=ghp_examplepatwithreadpackagescope

POSTGRES_PASSWORD=zQ5gG7k3S9nK2bFw
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:${POSTGRES_INTERNAL_PORT}/${POSTGRES_DB}?schema=public
DATABASE_DIRECT_URL=${DATABASE_URL}

REDIS_PASSWORD= # (only if protected Redis; keep blank otherwise)

RABBITMQ_PASSWORD=pV4hN1cLm2Xy8QwE
RABBITMQ_URL=amqp://${RABBITMQ_USERNAME}:${RABBITMQ_PASSWORD}@${RABBITMQ_HOST}:${RABBITMQ_PORT}

MINIO_ACCESS_KEY=mahanfileaccess
MINIO_SECRET_KEY=Z1x8dR5tC3nMm9pV

JWT_ACCESS_TOKEN_SECRET=8b4e1d6f3c2a9974bb1f6b80ec72dfb0
JWT_REFRESH_TOKEN_SECRET=5d7f2c4b1a9e3f6d8c1b0a7e5f2d4c6a

OTP_SENDER_BASE_URL=https://notify.mahanfile.ir/api/otp/send
OTP_SENDER_API_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.otp.mahanfile.token

NEXT_PUBLIC_ANALYTICS_WRITE_KEY=mahanfile-analytics-key-2025

OTEL_EXPORTER_OTLP_HEADERS= # add when tracing vendor requires authentication
TELEGRAM_BOT_TOKEN=8564124652:AAFgKx_GRMso0OR3DVdL_l5Nf24xPIdyvFI
